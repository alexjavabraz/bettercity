function criaString(e,o,a,t){return'	<form name="frm'+t+'" action="detalhe-demanda.html"><div id='+t+' class="form">	<nav class="" id='+t+'>	<a id="'+t+'" class="melhorar-minha-cidade-opcao-selecionada">Problema</a>	<a id="'+t+'" class="projects">Informação</a>	<a id="'+t+'" class="services">Sugestão</a>	<a id="'+t+'" put_before_onClick="this.className=\'melhorar-minha-cidade-opcao-selecionada\'" class="contact">Outro</a>	</nav>	<div class="formulario">   <input type="hidden" name="id"  id="formulario_lat'+t+'" value="'+t+'">   <input type="hidden" id="formulario_long'+t+'" value=>	<div>    <input type="text" class="formulario_input" id="formulario_titulo'+t+'" value="'+e+'" readonly /></div>	<div>   <textarea id="formulario_descricao'+t+'" class="formulario_textarea" maxlength="500" cols="50" rows="4">"'+a+'"</textarea>   </div>	<div><input type="text" id="formulario_endereco'+t+'" class="formulario_input" value="'+o+'" readonly /></div>	<div class="formulario_div_imagem"><img src="assets/images/icos/photo.png" class="formulario_imagem" id="formulario_imagem_'+t+'" onClick="enviarParaDetalhe('+t+');" class="formulario_button"/></div>	<div class="formulario_div_btn"><button class="btn" />Ver detalhe</div>	</div></form>'}function enviarParaDetalhe(e){}function initialize2(){var e="",o="",a="",t="",n="",i="";map=new google.maps.Map(document.getElementById("map-problema-apontado"),{zoom:17,center:new google.maps.LatLng(-23.548466,-46.6332475),mapTypeId:google.maps.MapTypeId.SATELLITE,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}});var l=function(){for(var e={},o=window.location.search.substring(1),a=o.split("&"),t=0;t<a.length;t++){var n=a[t].split("=");if("undefined"==typeof e[n[0]])e[n[0]]=decodeURIComponent(n[1]);else if("string"==typeof e[n[0]]){var i=[e[n[0]],decodeURIComponent(n[1])];e[n[0]]=i}else e[n[0]].push(decodeURIComponent(n[1]))}return e}(),r="http://"+document.location.host+"/rest/detalhe/get/"+l.id;$("#compartilharDetalheDemanda").click(function(e){e.preventDefault(),FB.ui({method:"feed",name:"Ajude a melhorar a cidade você também.",picture:"http://"+document.location.host+"/assets/images/melhore-a-cidade-fb.jpg",caption:"via MelhorarMinhaCidade.com.br",description:"Com o APP MelhorarMinhaCidade você mostra o que precisa ser melhorado, para os órgãos competentes, compartilha com seus amigos, acumula pontos e concorre á prêmios. Mostre o que você quer melhorar no seu bairro, na sua cidade!"})}),$.get(r,{id:l.id},function(l){if(""!=l){var r=JSON.parse(l);e=r.titulo,o=r.descricao,a=r.endereco,t=r.latitude,n=r.longitude,i=r.tipo;var s=new google.maps.LatLng(parseFloat(t),parseFloat(n));map.setCenter(s),new google.maps.Marker({position:s,map:map,icon:icons.problema.icon}),document.getElementById("titulo-do-problema-cidade").innerHTML=e,document.getElementById("texto-detalhe-do-problema").innerHTML=o,document.getElementById("data-do-problema").innerHTML=a}},"text")}function initialize(){function e(e,o){amarker=new google.maps.Marker({position:e,label:d[m++%d.length],map:o}),o.setCenter(e),amarker.setMap(null),amarker.setMap(o);var a="";a=""==userLogged?addPointNaoLogado():addPoint(amarker.position.lat(),amarker.position.lng()),o.getZoom()<18?(o.setZoom(18),amarker.setMap(null)):(marcacaoDoUsuarioNaoLogado=new google.maps.InfoWindow({content:a}),amarker.addListener("click",function(){marcacaoDoUsuarioNaoLogado.open(o,amarker)}),marcacaoDoUsuarioNaoLogado.open(o,amarker))}map=new google.maps.Map(document.getElementById("map"),{zoom:14,center:new google.maps.LatLng(-23.6057502,-46.9178099),mapTypeId:google.maps.MapTypeId.ROADMAP}),setInterval(function(){var e=document.createElement("script");console.log("finding points... http://"+document.location.host+"/rest/map"),e.src="http://"+document.location.host+"/rest/map",document.getElementsByTagName("head")[0].appendChild(e)},1e4);var o=document.getElementById("legend");for(var a in icons){var t=icons[a],n=t.name,i=t.icon,l=document.createElement("div");l.innerHTML='<img src="'+i+'" width="30px" height="30px"> '+n,o.appendChild(l)}map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(o),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){latitude=e.coords.latitude,longitude=e.coords.longitude;var o=e.coords.accuracy;e.timestamp;5e4>o?(localizacaoUsuario=new google.maps.Marker({position:{lat:latitude,lng:longitude},map:map,icon:pictureUser,title:"Você está aqui",label:"Você está aqui",zIndex:10,optimized:!0,draggable:!1}),map.setCenter(localizacaoUsuario.getPosition())):console.log("Accuracy exced limit "+o)},function(e){console.log(e)},{timeout:1e4},{maximumAge:2e4});var r=document.getElementById("pac-input"),s=new google.maps.places.SearchBox(r);map.controls[google.maps.ControlPosition.TOP_LEFT].push(r),map.addListener("bounds_changed",function(){s.setBounds(map.getBounds())});var c=[];s.addListener("places_changed",function(){var e=s.getPlaces();if(0!=e.length){c.forEach(function(e){e.setMap(null)}),c=[];var o=new google.maps.LatLngBounds;e.forEach(function(e){var a={url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};c.push(new google.maps.Marker({map:map,icon:a,title:e.name,position:e.geometry.location})),e.geometry.viewport?o.union(e.geometry.viewport):o.extend(e.geometry.location)}),map.fitBounds(o)}});var d="ABCDEFGHIJKLMNOPQRSTUVWXYZ",m=0;google.maps.event.addListener(map,"click",function(o){e(o.latLng,map)})}function addPointNaoLogado(){return document.getElementById("facaLogin").innerHTML}function addPoint(e,o){var a=Math.random();return codeLatLng(e,o,"formulario_endereco"+a),"	<div id="+a+' class="form">	<nav class="" id='+a+'>	<a  id="'+a+'a" onClick="select("'+a+'a", "'+a+'b", "'+a+'c", "'+a+'d");" class="home" >Problema</a>	<a  id="'+a+'b" onClick="select("'+a+'b", "'+a+'a", "'+a+'c", "'+a+'d");" class="projects">Informação</a>	<a  id="'+a+'c" onClick="select("'+a+'c", "'+a+'a", "'+a+'b", "'+a+'d");" class="services">Sugestão</a>	<a  id="'+a+'d" onClick="select("'+a+'d", "'+a+'a", "'+a+'c", "'+a+'b");" class="contact">Outro</a>	</nav>	<div class="formulario"><input type="hidden" id="formulario_lat'+a+'" value="'+e+'"><input type="hidden" id="formulario_long'+a+'" value="'+o+'">	<div><input type="text" class="formulario_input" id="formulario_titulo'+a+'" required placeholder="Qual o problema?" /></div>	<div><textarea id="formulario_descricao'+a+'" class="formulario_textarea" maxlength="500" cols="50" rows="4" placeholder="Descreva o problema, com o máximo de detalhes"></textarea></div>	<div><input type="text" id="formulario_endereco'+a+'" class="formulario_input" name="endereco" /></div>	<div class="formulario_div_imagem"><img src="assets/images/icos/photo.png" class="formulario_imagem" id="formulario_imagem_'+a+'" onClick="insertDemanda('+a+')" class="formulario_button"/></div>	<div class="formulario_div_btn"><button class="btn" onClick="insertDemanda('+a+')" class="formulario_button"/>Melhorar a cidade</div>	</div>'}function codeLatLng(e,o,a){var t=new google.maps.Geocoder,n=new google.maps.LatLng(e,o);t.geocode({latLng:n},function(e,o){o===google.maps.GeocoderStatus.OK?e[1]?null!=document.getElementById(a)&&(document.getElementById(a).value=e[0].formatted_address,console.log(e[0].formatted_address)):console.log("No results found"):console.log("Geocoder failed due to: "+o)})}function insertDemanda(e){var o=document.getElementById("formulario_titulo"+e).value,a=document.getElementById("formulario_descricao"+e).value,t=document.getElementById("formulario_endereco"+e).value,n=document.getElementById("formulario_lat"+e).value,i=document.getElementById("formulario_long"+e).value,l="http://"+document.location.host+"/rest/demanda/ins";$.post(l,{titulo:o,descricao:a,endereco:t,latitude:n,longitude:i},function(o){"ok"==o&&(document.getElementById(e).innerHTML=document.getElementById("parabens").innerHTML)},"text")}function insertCliente(e,o,a,t,n,i,l,r,s){var c="http://"+document.location.host+"/rest/cliente/ins";$.post(c,{nome:e,email:t,gender:l,id:n,locale:r,birthday:i,religion:s},function(e){},"text")}function enviarContato(){var e="http://"+document.location.host+"/rest/contato/ins",o=document.getElementById("email"),a=document.getElementById("message");$.post(e,{nome:"",email:o.value,descricao:a.value,lat:"",lon:""},function(e){},"text"),o.value="",a.value=""}function loginFaceBook(){console.log("Welcome!  Fetching your information.... "),FB.api("/me?fields=name,first_name,last_name,email,picture,id,birthday,gender,locale, religion, hometown",function(e){console.log("Successful login for: "+e.name),console.log("name, "+e.name+"."),console.log("email, "+e.email+"."),console.log("first_name, "+e.first_name+"."),console.log("last_name, "+e.last_name+"."),console.log("id, "+e.id+"."),console.log("birthday, "+e.birthday+"."),console.log("Gender, "+e.gender+"."),console.log("locale, "+e.locale+"."),console.log("Religion, "+e.religion+"."),pictureUser=e.picture.data.url,userLogged=e,"undefined"==pictureUser?pictureUser=iconBase+"voce-esta-aqui.png":localizacaoUsuario.setIcon(pictureUser),insertCliente(e.name,e.first_name,e.last_name,e.email,e.id,e.birthday,e.gender,e.locale,e.religion),document.getElementById("pw-mask").style.display="none",document.getElementById("signwall").style.display="none",document.getElementById("login").innerHTML=e.name,""!=marcacaoDoUsuarioNaoLogado&&amarker.setMap(null)})}function select(e,o,a,t){document.getElementById(e).className="melhorar-minha-cidade-opcao-selecionada",document.getElementById(o).className="home",document.getElementById(a).className="home",document.getElementById(t).className="home"}var map,pictureUser="",amarker="",userLogged="",marcacaoDoUsuarioNaoLogado="",address="",iconBase="http://"+document.location.host+"/assets/images/icos/",localizacaoUsuario="",latitude,longitude,itens=[],icons={problema:{name:"Problema",icon:iconBase+"problema.png"},melhorado:{name:"Melhorado",icon:iconBase+"problema-corrigido.png"},working:{name:"Atuando",icon:iconBase+"obra-em-andamento.png"},info:{name:"Informa&#231;&#227;o",icon:iconBase+"poder-publico-analisando.png"}};window.eqfeed_callback=function(e){console.log("calling callback... "+e.features.length);for(var o=0;o<e.features.length;o++){var a=e.features[o].geometry.coordinates,t=new google.maps.LatLng(a[0],a[1]),n=e.features[o].properties.title,i=e.features[o].properties.place,l=parseInt(e.features[o].id),r=e.features[o].properties.detail,s=e.features[o].properties.type;itens[l]=i,new google.maps.Marker({position:t,map:map,title:n,label:r,icon:icons[s].icon,zIndex:l,optimized:!0,draggable:!1}).addListener("click",function(){new google.maps.InfoWindow({content:criaString(this.title,itens[this.zIndex],this.label,this.zIndex)}).open(map,this)})}};var myJSONData='{"data":{"mode" : "subscribe","technologyareas":[1],"assettypes":["podcast","documents"]}}',url="res/demanda/ins";$(document).ready(function(){var e=1e3;$("#pw-mask").click(function(){$("#pw-mask").hide(e),$("#signwall").hide(e)}),$("#login").click(function(){console.log($("#login").html()),loginFaceBook(),"Acessar"==$("#login").html()&&($("#pw-mask").show(e),$("#signwall").show(e))})});